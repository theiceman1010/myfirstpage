<HTML>
<HEAD>
<script src="http://code.jquery.com/jquery-3.2.1.js">
</script>


<STYLE>
body {
    font-size: 12pt;
    font-family: Calibri;
    padding : 10px;
}
table {
    border: 1px solid black;
}
th {
    border: 1px solid black;
    padding: 5px;
    background-color:grey;
    color: white;
}
td {
    border: 1px solid black;
    padding: 5px;
}
input {
    font-size: 12pt;
    font-family: Calibri;
}
</STYLE>
</HEAD>
<BODY>

<SCRIPT>
window.onload=function(){
document.querySelector('a').addEventListener('click', (a) => {
  let csv = '';
  const table = document.querySelector('table');

  csv += Array.prototype.map.call(table.querySelectorAll('thead th'), (th) => {
    return `"${th.innerText.replace(/"/g, '""')}"`;
  }).join(',') + "\n";

  Array.prototype.forEach.call(table.querySelectorAll('tbody tr'), (tr) => {
    csv += Array.prototype.map.call(tr.querySelectorAll('td'), (td) => {
      return `"${td.innerText.replace(/"/g, '""')}"`;
    }).join(',') + "\n";a
  });

  event.target.setAttribute('download', 'csv.csv');
  event.target.setAttribute('href', URL.createObjectURL(new Blob([csv], { type: 'text/csv;charset=utf8' })));
});


};
</SCRIPT>


<table>
  <thead>
    <tr>
      <th>col 1</th>
      <th>col 2 "bad"</th>
      <th>col 3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>val 1</td>
      <td>val 2</td>
      <td>val 3</td>
    </tr>
    <tr>
      <td>val a</td>
      <td>val b</td>
      <td>val c</td>
    </tr>
    <tr>
      <td>"x"</td>
      <td>y</td>
      <td>z</td>
    </tr>
  </tbody>
</table>

<a href="#">download</a>


</BODY>

</HTML>
